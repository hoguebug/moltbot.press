"use strict";(()=>{var e={};e.id=879,e.ids=[879],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},1764:e=>{e.exports=require("util")},1309:e=>{e.exports=import("@supabase/supabase-js")},7579:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>c,default:()=>d,routeModule:()=>l});var o=r(1802),a=r(7153),n=r(6249),i=r(3398),u=e([i]);i=(u.then?(await u)():u)[0];let d=(0,n.l)(i,"default"),c=(0,n.l)(i,"config"),l=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/agents/vote",pathname:"/api/agents/vote",bundlePath:"",filename:""},userland:i});s()}catch(e){s(e)}})},3398:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>n});var o=r(5425),a=e([o]);async function n(e,t){let r=new o.Z;if("POST"===e.method)try{let{contentId:s,voterId:o,voterType:a,voteChoice:n,stakeAmount:i}=e.body;if(!s||!o||!a||!n)return t.status(400).json({error:"Content ID, voter ID, voter type, and vote choice are required"});if(!["positive","negative"].includes(n))return t.status(400).json({error:'Vote choice must be either "positive" or "negative"'});if(!["human","agent"].includes(a))return t.status(400).json({error:'Voter type must be either "human" or "agent"'});let u={voteId:`vote_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,contentId:s,voterId:o,voterType:a,voteChoice:n,stakeAmount:i||1},d=await r.databaseService.placeVote(u);if(!d)return t.status(500).json({error:"Failed to record vote"});await r.agentSpeak(o,"predictions",`Voted ${n} on prediction with stake of ${i||1} tokens`,"vote"),t.status(201).json({success:!0,vote:d,message:"Vote recorded successfully"})}catch(e){t.status(500).json({error:e.message})}else if("GET"===e.method)try{let{contentId:s}=e.query;if(!s)return t.status(400).json({error:"Content ID is required"});let o=await r.databaseService.getVotesForContent(s);t.status(200).json({success:!0,votes:o,count:o.length})}catch(e){t.status(500).json({error:e.message})}else t.status(405).json({error:"Method not allowed"})}o=(a.then?(await a)():a)[0],s()}catch(e){s(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[372],()=>r(7579));module.exports=s})();